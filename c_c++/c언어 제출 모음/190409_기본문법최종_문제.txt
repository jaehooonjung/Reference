#include<stdio.h>
#include<Windows.h>
#define TRUE 1
void main()
{
	int day = 1, choice, hp = 100, money = 0, rate = 100, time = 0, usetime = 0, countdown = -1;
	char name[15];
	printf("회원 이름 입력 : ");
	scanf("%s", name);

	while (rate > 1) //무한루프를 벗어나는 방법으로 #define TRUE 1와 false 를 선언하고 while안에 flag넣어서 해도 좋음
	{
		system("cls");
		printf("====%s님의 생활====(%d째날)\n", name, day);
		printf("1.일하기\n");
		printf("2.휴식\n");
		printf("3.피시방 이동\n");
		printf("4.정보보기\n");
		printf("5.종료\n");
		printf("입력 : ");
		scanf("%d", &choice);

		switch (choice)
		{
		case 1:
			if (hp < 30)
			{
				printf("체력이 없습니다.\n");
				system("pause");
				break;
			}
			if (countdown > 0)
			{
				printf("병원에 있어 일을 할 수 없습니다(countdown : %d)\n", countdown);
				system("pause");
				break;
			}
			printf("체력이 감소하였습니다(-30)\n");
			printf("수당을 획득하였습니다.(+10000원)\n");
			hp -= 30;
			money += 10000;
			system("pause");
			break;
		case 2:
			printf("하루가 지났습니다(+Day)\n");
			if (hp == 0)
			{
				printf("체력이 0인 상태로 하루가 끝나 병원으로 이동하여 3일동안 일과 게임을 할 수 없습니다.\n");
				countdown = 4;
			}
			if (countdown >= 0 && countdown < 3)
				printf("병원에서 하루가 지났습니다(countdown : %d)\n", countdown);
			printf("건강이 회복되었습니다(+50)\n");
			day += 1;
			hp += 50;
			countdown--;
			system("pause");
			break;
		case 3:
			if (countdown > 0)
			{
				printf("병원에 있어 방문할 수 없습니다(countdown : %d)\n", countdown);
				system("pause");
				break;
			}

			while (rate > 1)
			{
				system("cls");
				printf("====팡팡 pc방(%s회원님)====\n", name);
				printf("1.시간등록\n");
				printf("2.사용자 정보\n");
				printf("3.시간 사용하기\n");
				printf("4.pc방 나가기\n");
				printf("입력 : ");
				scanf("%d", &choice);
				system("cls");
				switch (choice)
				{
				case 1:
					while (TRUE)
					{
						printf("보유 금액 : %d\t보유 시간 : %d\n", money, time);
						printf("등록할 시간을 입력하시오(시간당 1000원, 그냥 나가기 : 0) : ");
						scanf("%d", &usetime);
						if (usetime == 0)
							break;
						if (money >= (usetime * 1000))
							break;
						printf("보유 금액이 부족합니다. 다시 입력해 주세요\n");
						system("pause");
						system("cls");
					}
					time += usetime;
					money -= usetime * 1000;
					printf("%d시간이 등록되었습니다.\n", usetime);
					printf("남은 금액 : %d\n보유 시간 : %d\n", money, time);
					system("pause");
					break;

				case 2:
					printf("====%s님의 정보====\n", name);
					printf("보유 금액 : %d\t보유 시간 : %d\n", money, time);
					printf("Ranking : %d\n", rate);
					system("pause");
					break;

				case 3:
					while (TRUE)
					{
						system("cls");
						printf("====%s님의 정보====\n", name);
						printf("보유 금액 : %d\t보유 시간 : %d\n", money, time);
						printf("Ranking : %d\n", rate);
						printf("사용할 시간을 입력하시오(최대 사용가능시간당 %d, 시간당 1000원(나가기 : 0) : ", hp / 10);
						scanf("%d", &usetime);
						if (usetime == 0)
							break;
						if (usetime <= (hp / 10))
							break;
						printf("시간이 부족합니다. 다시입력하여 주세요\n");
						system("pause");
					}
					if (usetime == 0) 
						break;
					hp -= usetime * 10;
					rate -= usetime;
					printf("%d시간 play하였습니다.\n10만큼의 건강이 감소하였습니다(시간당 10)\n", usetime);
					printf("Ranking이 %d만큼 증가 하였습니다. (%d->%d)\n", usetime, rate + usetime, rate);
					if (rate <= 1)
					{
						printf("%d일 만에 1등이 되었습니다.(종료)\n", day);
						system("pause");
						break;
					}
					system("pause");
					break;
				case 4:
					break; //return; 은 프로그램이 아예 종료됩니다....
				}
				if (choice == 4)
					break;
			}
			break;

		case 4:
			printf("====%s님의 정보====\n", name);
			printf("This Day : %d째날\n", day);
			printf("보유 금액 : %d\t건강 : %d\n", money, hp);
			printf("Ranking : %d\n", rate);
			printf("================\n");
			system("pause");
			break;

		case 5:
			printf("안녕히가십시오.");
			system("pause");
			return;
		}
	}
}